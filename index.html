<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<meta name="color-scheme" content="dark">
<meta name="theme-color" content="#03040a">
<title>Radar de Editais ‚Äî Virtus et Honor</title>

<style>
  :root{
    --bg-start:#03040a;
    --bg-end:#0b1118;
    --card-start:#071018;
    --card-end:#0f1723;
    --muted:rgba(230,230,230,.72);
    --accent-1:#8be9fd;
    --accent-2:#bd93f9;
    --accent-3:#ff79c6;
    --danger:#ff3b3b;
    --warn:#ffd93b;
    --info:#3ba0ff;
    --success:#50fa7b;
    --radius:12px;
    --max-default:980px;
    --transition:.16s;
    --font-sans:Inter,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;
  }

  *,*::before,*::after{box-sizing:border-box}
  html,body{
    height:100%;margin:0;padding:0;color:#e6e6e6;font-family:var(--font-sans);
    -webkit-font-smoothing:antialiased;background:linear-gradient(180deg,var(--bg-start),var(--bg-end));
  }
  /* embed support: transparent background if embedded */
  html[data-embed] body { background:transparent; }

  #radarWrap{width:100%;max-width:var(--max-default);margin:12px auto;padding:0;transition:max-width var(--transition) ease}
  #radar{background:linear-gradient(180deg,var(--bg-start),var(--bg-end));border:1px solid rgba(255,255,255,.03);padding:16px;border-radius:14px;box-shadow:0 8px 30px rgba(2,6,23,.6)}

  .header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:12px}
  .title{font-weight:800;font-size:18px;background:linear-gradient(90deg,var(--accent-1),var(--accent-2),var(--accent-3));-webkit-background-clip:text;color:transparent}
  .subtitle{font-size:12px;color:var(--muted)}
  .controls{display:flex;gap:8px;align-items:center}
  .ctrl-btn{background:transparent;border:1px solid rgba(255,255,255,.04);padding:6px 10px;border-radius:8px;cursor:pointer;color:var(--muted);font-size:13px}
  .ctrl-btn:focus{outline:3px solid rgba(139,233,253,.12);outline-offset:3px}
  .ctrl-btn:hover{border-color:rgba(255,255,255,.08)}

  .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:12px;align-items:start}
  .section-title{grid-column:span 12;color:var(--muted);font-size:14px;margin-top:6px;margin-bottom:6px;font-weight:700}

  .card{grid-column:span 12;background:linear-gradient(145deg,var(--card-start),var(--card-end));border:1px solid rgba(255,255,255,.03);padding:12px;border-radius:12px;position:relative;cursor:pointer;transition:transform .14s ease,border-color .14s ease,box-shadow .14s ease;user-select:none;display:flex;align-items:center;justify-content:space-between;gap:12px}
  .card:hover{transform:translateY(-4px);box-shadow:0 12px 36px rgba(0,0,0,.5);border-color:rgba(255,255,255,.06)}
  .card.small{padding:10px}
  .card::before{content:"";position:absolute;left:0;top:0;bottom:0;width:4px;border-radius:6px 0 0 6px}
  .alvo::before{background:var(--danger)} .obs::before{background:var(--warn)} .reta::before{background:var(--info)}

  .card .left{display:flex;flex-direction:column;gap:4px}
  .name{font-weight:700;font-size:15px}
  .meta{font-size:12px;color:var(--muted)}
  .pill{font-size:11px;padding:6px 10px;border-radius:999px;background:rgba(0,0,0,.28);border:1px solid rgba(255,255,255,.03);white-space:nowrap}
  .pill.previsto{color:var(--accent-1);border-color:var(--accent-1)} .pill.autorizado{color:var(--success);border-color:var(--success)}
  .pill.pldo{color:var(--warn);border-color:var(--warn)} .pill.longo{color:var(--info);border-color:var(--info)}
  .tag-small{font-size:11px;color:var(--muted)}

  /* modal / panel */
  .overlay{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,rgba(1,2,5,.55),rgba(1,2,5,.72));z-index:9999;backdrop-filter:blur(3px)}
  .panel{width:min(920px,96%);max-height:86vh;border-radius:12px;background:linear-gradient(180deg,#071018,#0c1218);border:1px solid rgba(255,255,255,.04);box-shadow:0 20px 60px rgba(0,0,0,.7);display:flex;flex-direction:column;overflow:hidden}
  .panel-header{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;border-bottom:1px solid rgba(255,255,255,.02)}
  .panel-title{font-weight:800;font-size:16px}
  .panel-sub{font-size:12px;color:var(--muted)}
  .panel-body{display:flex;gap:16px;padding:16px;overflow:auto}
  .panel-left{min-width:260px;border-right:1px solid rgba(255,255,255,.02);padding-right:12px}
  .panel-right{flex:1;min-width:200px}
  .close-btn{background:transparent;border:0;color:var(--muted);cursor:pointer;font-size:20px;padding:4px 8px;border-radius:8px}
  .tablist{display:flex;gap:8px;margin-bottom:12px}
  .tab{padding:8px 12px;border-radius:8px;border:1px solid rgba(255,255,255,.03);background:transparent;color:var(--muted);cursor:pointer}
  .tab[aria-selected="true"]{background:linear-gradient(90deg,var(--accent-1),var(--accent-2));-webkit-background-clip:text;color:transparent;border-color:rgba(255,255,255,.06)}
  .detail-html{font-size:14px;color:#e6e6e6;line-height:1.45}
  .small-meta{font-size:12px;color:var(--muted);margin-top:8px}

  .sr-only{position:absolute !important;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}

  @media (min-width:980px){
    #radarWrap.grouped .grid .card.half{grid-column:span 6}
    .panel-body{padding:20px}
  }
  @media (max-width:480px){
    .panel{width:100%;height:100%;border-radius:0}
    .panel-body{flex-direction:column}
    .panel-left{width:100%;border-right:0;padding:0}
  }
</style>
</head>
<body>
<div id="radarWrap" class="grouped" role="region" aria-label="Radar de Editais ‚Äî Virtus et Honor">
  <div id="radar" role="application" aria-describedby="radar-note">
    <div class="header">
      <div>
        <div class="title">üì° Radar de Editais ‚Äî Virtus et Honor</div>
        <div class="subtitle" id="updatedAt">Atualizado em: 20/02/2026</div>
      </div>

      <div class="controls" role="toolbar" aria-label="Controles do widget">
        <button id="toggleLayout" class="ctrl-btn" title="Alternar modo">Modo: Prioridade</button>
        <button id="helpBtn" class="ctrl-btn" title="Ajuda (H)">i</button>
      </div>
    </div>

    <div class="grid" id="grid" role="list" aria-live="polite"></div>
  </div>
</div>

<!-- modal / painel com abas internas -->
<div id="overlay" class="overlay" hidden aria-hidden="true" role="dialog" aria-modal="true">
  <div class="panel" role="document" aria-labelledby="panelTitle">
    <div class="panel-header">
      <div>
        <div id="panelTitle" class="panel-title"></div>
        <div id="panelSub" class="panel-sub"></div>
      </div>
      <div>
        <button id="panelClose" class="close-btn" aria-label="Fechar painel">‚úï</button>
      </div>
    </div>

    <div class="panel-body">
      <div class="panel-left" id="panelLeft">
        <div class="small-meta" id="panelWhen"></div>
        <div class="small-meta" id="panelStatus"></div>
        <div style="margin-top:12px">
          <div style="font-size:13px;color:var(--muted);font-weight:700;margin-bottom:8px">A√ß√µes r√°pidas</div>
          <div style="display:flex;gap:8px;flex-wrap:wrap">
            <button id="focusAnki" class="ctrl-btn" title="Criar cart√£o (placeholder)">Criar Anki</button>
            <button id="addWatch" class="ctrl-btn" title="Marcar para acompanhar">Acompanhar</button>
          </div>
        </div>
      </div>

      <div class="panel-right">
        <div class="tablist" role="tablist" aria-label="Abas do painel">
          <button class="tab" role="tab" id="tab-desc" aria-selected="true" tabindex="0">Descri√ß√£o</button>
          <button class="tab" role="tab" id="tab-full" aria-selected="false" tabindex="-1">Texto completo</button>
        </div>
        <div id="tabPanelDesc" role="tabpanel" tabindex="0" class="detail-html"></div>
        <div id="tabPanelFull" role="tabpanel" tabindex="0" class="detail-html" hidden></div>
      </div>
    </div>
  </div>
</div>

<script>
/* ========== dados (edite aqui) ========== */
const updatedAtText = "20/02/2026";

/* cada item: key, titulo (curto), tituloFull, grupo (alvo/obs/reta), tag, data (ISO), short (preview p/ cart√£o), html (descri√ß√£o resumida), full (texto completo) */
const concursos = [
  {
    key: "pmgo",
    titulo: "PM-GO",
    tituloFull: "Pol√≠cia Militar do Estado de Goi√°s ‚Äî Concurso Soldado",
    grupo: "alvo",
    tag: "PREVISTO",
    data: "2026-09-01",
    short: "Pr√≥ximo edital tende a sair entre jul‚Äìout/2026; pico em set/2026; prova nov/2026.",
    html: `<strong>Pol√≠cia Militar do Estado de Goi√°s ‚Äî Soldado</strong><br>Pr√≥ximo edital: <strong>jul‚Äìout/2026</strong>, pico em <strong>set/2026</strong>. Prova estimada em <strong>nov/2026</strong>.`,
    full: `PM-GO ‚Äî Pr√≥ximo edital de Soldado tende a sair entre julho e outubro de 2026, com pico de probabilidade em setembro de 2026 e prova em novembro de 2026.`
  },
  {
    key: "prf",
    titulo: "PRF",
    tituloFull: "Pol√≠cia Rodovi√°ria Federal ‚Äî Concurso Nacional",
    grupo: "alvo",
    tag: "M√âDIO PRAZO",
    data: "2026-11-01",
    short: "Concurso 2021 v√°lido at√© jun/2026; cen√°rio prov√°vel: edital 2¬∫ sem/2026, provas in√≠cio de 2027.",
    html: `<strong>Pol√≠cia Rodovi√°ria Federal ‚Äî PRF</strong><br>Concurso 2021 prorrogado at√© <strong>jun/2026</strong>. Mais prov√°vel: edital no <strong>2¬∫ semestre de 2026</strong> (set‚Äìdez) e provas no in√≠cio de 2027.`,
    full: `PRF ‚Äî Concurso 2021 prorrogado at√© junho de 2026; isso empurra o novo edital para ap√≥s essa data. Cen√°rio prov√°vel √© edital no 2¬∫ semestre de 2026 (setembro‚Äìdezembro), com provas no in√≠cio de 2027. H√° pedidos de vagas (ex.: 511 vagas) e pedidos maiores em an√°lise.`
  },

  {
    key: "pcmt",
    titulo: "PC-MT",
    tituloFull: "Pol√≠cia Civil do Estado de Mato Grosso ‚Äî Investigador/Escriv√£o",
    grupo: "obs",
    tag: "PLDO",
    data: "2026-10-01",
    short: "Previsto no PLDO 2026; edital projetado para 2¬∫ sem/2026 ap√≥s validade do √∫ltimo concurso.",
    html: `<strong>Pol√≠cia Civil - MT</strong><br>Previsto no PLDO 2026. Poss√≠vel edital no segundo semestre de 2026.`,
    full: `PC-MT ‚Äî Novo concurso previsto no PLDO 2026, com edital projetado para o segundo semestre de 2026, ap√≥s o fim da validade do √∫ltimo concurso (Investigador/Escriv√£o v√°lido at√© junho de 2026).`
  },
  {
    key: "pmt",
    titulo: "PM-MT",
    tituloFull: "Pol√≠cia Militar do Estado de Mato Grosso",
    grupo: "obs",
    tag: "PLDO",
    data: "2026-10-15",
    short: "Previsto no PLDO; vagas para Aluno Oficial e Soldado; depende de dota√ß√£o.",
    html: `<strong>Pol√≠cia Militar - MT</strong><br>Previsto no PLDO 2026; expectativa de edital em 2026, vinculado a dota√ß√£o or√ßament√°ria.`,
    full: `PM-MT ‚Äî Concurso previsto no PLDO 2026 com vagas para Aluno Oficial e Soldado; expectativa de edital em 2026, vinculado ao or√ßamento sinalizado na Assembleia Legislativa.`
  },
  {
    key: "pcdf",
    titulo: "PC-DF",
    tituloFull: "Pol√≠cia Civil do Distrito Federal ‚Äî Perito / Papiloscopista",
    grupo: "obs",
    tag: "AUTORIZADO",
    data: "2026-12-01",
    short: "Autorizado: 105 vagas + 210 CR; expectativa 2026‚Äìin√≠cio 2027.",
    html: `<strong>Pol√≠cia Civil - DF</strong><br>Autorizado: <strong>105 vagas + 210 CR</strong>. Expectativa de edital entre 2026 e in√≠cio de 2027.`,
    full: `PC-DF ‚Äî Concurso autorizado com 105 vagas + 210 CR (Perito/Papiloscopista/Perito M√©dico-Legista). Forte expectativa de edital entre 2026 e in√≠cio de 2027.`
  },
  {
    key: "pcpr",
    titulo: "PC-PR",
    tituloFull: "Pol√≠cia Civil do Paran√° ‚Äî Delegado / Agente",
    grupo: "obs",
    tag: "AUTORIZADO",
    data: "2026-09-15",
    short: "Autorizado e comiss√£o formada; previs√£o de edital 2¬∫ sem/2026.",
    html: `<strong>Pol√≠cia Civil - PR</strong><br>Autorizado oficialmente com comiss√£o formada. Previs√£o de edital no 2¬∫ semestre de 2026.`,
    full: `PC-PR ‚Äî Autorizado oficialmente com comiss√£o formada para Delegado, Agente e Papiloscopista. Previs√£o de edital no 2¬∫ semestre de 2026.`
  },
  {
    key: "pf",
    titulo: "PF",
    tituloFull: "Pol√≠cia Federal ‚Äî Concurso Nacional",
    grupo: "reta",
    tag: "LONGO PRAZO",
    data: "2028-06-01",
    short: "Tende a ficar para 2028+, ap√≥s ciclo atual e prioriza√ß√£o de outras pol√≠cias.",
    html: `<strong>Pol√≠cia Federal</strong><br>Pr√≥ximo grande concurso tende a ficar para <strong>2028+</strong>.`,
    full: `PF ‚Äî Pr√≥ximo grande concurso de n√≠vel nacional tende a ficar para 2028 em diante, ap√≥s o ciclo atual de convoca√ß√µes e prioriza√ß√£o de PRF e pol√≠cias penais estaduais.`
  },
  {
    key: "pcgo",
    titulo: "PC-GO",
    tituloFull: "Pol√≠cia Civil do Estado de Goi√°s",
    grupo: "reta",
    tag: "ESTUDO",
    data: "2027-03-01",
    short: "Em estudo; cen√°rio 2026/2027 ap√≥s consolida√ß√£o de PMGO e ajustes or√ßament√°rios.",
    html: `<strong>Pol√≠cia Civil - GO</strong><br>Em estudo; poss√≠vel 2026‚Äì2027.`,
    full: `PC-GO ‚Äî Novo concurso em estudos, sem estrutura avan√ßada; cen√°rio realista √© edital a partir de 2026/2027, ap√≥s consolida√ß√£o dos concursos da PMGO e ajustes or√ßament√°rios.`
  },
  {
    key: "pcto",
    titulo: "PC-TO",
    tituloFull: "Pol√≠cia Civil do Estado do Tocantins",
    grupo: "reta",
    tag: "COMISS√ÉO",
    data: "2027-02-01",
    short: "Comiss√£o e movimenta√ß√µes; chances de edital em 2026/2027.",
    html: `<strong>Pol√≠cia Civil - TO</strong><br>Comiss√µes e movimenta√ß√µes indicam chances de edital em 2026/2027.`,
    full: `PC-TO ‚Äî Comiss√£o e movimenta√ß√µes apontam chances de edital em 2026/2027. Monitorar.`
  }
];

/* ordem de grupos (exibicao) */
const gruposOrdem = [
  { id:"alvo", titulo:"üëÅ‚Äçüó® Em Alvo (Prioridade M√°xima)" },
  { id:"obs", titulo:"‚ö†Ô∏è Em Observa√ß√£o" },
  { id:"reta", titulo:"‚ùÑÔ∏è Na Retaguarda (Monitoramento Estrat√©gico)" }
];

/* ========== utilidades ========== */
const grid = document.getElementById('grid');
const toggleLayoutBtn = document.getElementById('toggleLayout');
const helpBtn = document.getElementById('helpBtn');
const radarWrap = document.getElementById('radarWrap');
const updatedAtEl = document.getElementById('updatedAt');

let mode = 'group'; // group => Prioridade ; time => Proximidade
updatedAtEl.textContent = `Atualizado em: ${updatedAtText}`;

function parseDateISO(d){ return d? new Date(d + 'T00:00:00') : null; }
function formatDate(d){
  if(!d) return '';
  const dt = parseDateISO(d);
  const day = String(dt.getDate()).padStart(2,'0');
  const mon = String(dt.getMonth()+1).padStart(2,'0');
  const yr = dt.getFullYear();
  return `${day}/${mon}/${yr}`;
}
function tempoRestanteISO(d){
  const alvo = parseDateISO(d);
  if(!alvo) return '';
  const hoje = new Date();
  // clear time-of-day effect
  const diff = alvo.setHours(0,0,0,0) - new Date(hoje.getFullYear(),hoje.getMonth(),hoje.getDate()).getTime();
  if(diff<=0) return 'SAIU';
  const days = Math.floor(diff/86400000);
  const months = Math.floor(days/30);
  if(months>0) return `${months}m`;
  if(days>0) return `${days}d`;
  return '0d';
}

function pillClass(label){
  const map = {
    'PREVISTO':'previsto',
    'M√âDIO PRAZO':'previsto',
    'PLDO':'pldo',
    'AUTORIZADO':'autorizado',
    'LONGO PRAZO':'longo',
    'ESTUDO':'pldo',
    'COMISS√ÉO':'pldo',
    'COMISS√ÉO':'pldo'
  };
  return map[label] || '';
}

/* ========== render grouped (Prioridade) ========== */
function renderGrouped(){
  grid.innerHTML = '';
  for(const g of gruposOrdem){
    const sec = document.createElement('div');
    sec.className = 'section-title';
    sec.textContent = g.titulo;
    grid.appendChild(sec);

    const itens = concursos.filter(c=>c.grupo===g.id);
    if(itens.length===0){
      const empty = document.createElement('div');
      empty.className = 'card small';
      empty.innerHTML = `<div class="left"><div class="name">‚Äî</div><div class="meta">Sem alvos nessa categoria</div></div>`;
      grid.appendChild(empty);
    }

    for(const c of itens){
      const el = document.createElement('div');
      el.className = `card ${c.grupo}`;
      el.setAttribute('data-key', c.key);
      el.tabIndex = 0;
      el.innerHTML = `
        <div class="left">
          <div class="name">${c.tituloFull}</div>
          <div class="meta">${c.short}</div>
        </div>
        <div style="display:flex;flex-direction:column;align-items:flex-end;gap:8px">
          <div><span class="pill ${pillClass(c.tag)}">${c.tag}</span></div>
          <div class="tag-small">${formatDate(c.data)}</div>
        </div>
      `;
      el.addEventListener('click', ()=> openPanelByKey(c.key));
      el.addEventListener('keydown', (e)=> { if(e.key==='Enter' || e.key===' '){ e.preventDefault(); openPanelByKey(c.key); }});
      grid.appendChild(el);
    }
  }
}

/* ========== render time-ordered (Proximidade) ========== */
function renderTime(){
  grid.innerHTML = '';
  const items = [...concursos].sort((a,b)=> parseDateISO(a.data)-parseDateISO(b.data));
  for(const c of items){
    const el = document.createElement('div');
    el.className = `card ${c.grupo} small`;
    el.setAttribute('data-key', c.key);
    el.tabIndex = 0;
    el.innerHTML = `
      <div style="text-align:left">
        <div style="font-size:16px;font-weight:700">${c.titulo}</div>
        <div style="font-size:12px;color:var(--muted);margin-top:6px">${c.short}</div>
      </div>
      <div style="text-align:right;min-width:76px">
        <div style="font-size:18px;font-weight:800">‚è≥ ${tempoRestanteISO(c.data)}</div>
        <div style="font-size:11px;color:var(--muted);margin-top:6px">${formatDate(c.data)}</div>
      </div>
    `;
    el.addEventListener('click', ()=> openPanelByKey(c.key));
    el.addEventListener('keydown', (e)=> { if(e.key==='Enter' || e.key===' '){ e.preventDefault(); openPanelByKey(c.key); }});
    grid.appendChild(el);
  }
}

/* ========== panel/modal with tabs ========== */
const overlay = document.getElementById('overlay');
const panelTitle = document.getElementById('panelTitle');
const panelSub = document.getElementById('panelSub');
const panelWhen = document.getElementById('panelWhen');
const panelStatus = document.getElementById('panelStatus');
const tabDesc = document.getElementById('tab-desc');
const tabFull = document.getElementById('tab-full');
const tabPanelDesc = document.getElementById('tabPanelDesc');
const tabPanelFull = document.getElementById('tabPanelFull');
const panelClose = document.getElementById('panelClose');

let lastFocused = null;

function openPanelByKey(key){
  const data = concursos.find(c=>c.key===key);
  if(!data) return;
  lastFocused = document.activeElement;
  panelTitle.textContent = data.titulo;
  panelSub.textContent = data.tituloFull;
  panelWhen.textContent = `Previs√£o / Data: ${formatDate(data.data)} ‚Ä¢ Proximidade: ${tempoRestanteISO(data.data)}`;
  panelStatus.textContent = `Status: ${data.tag}`;
  tabPanelDesc.innerHTML = data.html;
  tabPanelFull.innerText = data.full;
  // show overlay
  overlay.hidden = false; overlay.removeAttribute('aria-hidden');
  // reset tabs
  setActiveTab(tabDesc);
  // focus panel for keyboard
  setTimeout(()=> tabPanelDesc.focus(),60);
  // lock scroll
  try{ document.documentElement.style.overflow = 'hidden'; }catch(e){}
}

function closePanel(){
  overlay.hidden = true; overlay.setAttribute('aria-hidden','true');
  try{ document.documentElement.style.overflow = ''; }catch(e){}
  if(lastFocused && typeof lastFocused.focus === 'function') lastFocused.focus();
}

/* tabs keyboard & click behavior */
function setActiveTab(tabEl){
  [tabDesc, tabFull].forEach(t=> {
    const sel = (t===tabEl);
    t.setAttribute('aria-selected', sel?'true':'false');
    t.tabIndex = sel?0:-1;
  });
  // panels
  if(tabEl===tabDesc){
    tabPanelDesc.hidden = false;
    tabPanelFull.hidden = true;
  } else {
    tabPanelDesc.hidden = true;
    tabPanelFull.hidden = false;
  }
}

tabDesc.addEventListener('click', ()=> setActiveTab(tabDesc));
tabFull.addEventListener('click', ()=> setActiveTab(tabFull));

tabDesc.addEventListener('keydown', (e)=> {
  if(e.key==='ArrowRight') { setActiveTab(tabFull); tabFull.focus(); }
  if(e.key==='ArrowLeft')  { setActiveTab(tabDesc); }
});
tabFull.addEventListener('keydown', (e)=> {
  if(e.key==='ArrowLeft') { setActiveTab(tabDesc); tabDesc.focus(); }
  if(e.key==='ArrowRight') { setActiveTab(tabFull); }
});

/* panel controls */
panelClose.addEventListener('click', closePanel);
overlay.addEventListener('click', (e)=> { if(e.target===overlay) closePanel(); });
document.addEventListener('keydown', (e)=> {
  if(e.key==='Escape' && !overlay.hidden) closePanel();
});

/* help button */
helpBtn.addEventListener('click', ()=> {
  // show small help inside panel
  const helpHtml = `<strong>Ajuda ‚Äî Radar</strong><br><br>
  - Clique em um card para abrir detalhes.<br>
  - Fechar: ESC, clicar fora ou no ‚úï.<br>
  - Atalhos: <strong>M</strong> para alternar modo (Prioridade/Proximidade), <strong>H</strong> abrir ajuda.<br>
  - No painel: use as abas (Descri√ß√£o / Texto completo).`;
  // use a temporary panel
  panelTitle.textContent = 'Ajuda ‚Äî Radar';
  panelSub.textContent = '';
  panelWhen.textContent = '';
  panelStatus.textContent = '';
  tabPanelDesc.innerHTML = helpHtml;
  tabPanelFull.innerHTML = '';
  setActiveTab(tabDesc);
  overlay.hidden = false; overlay.removeAttribute('aria-hidden');
  setTimeout(()=> tabPanelDesc.focus(),60);
});

/* toggle layout */
function toggleLayout(){
  if(mode==='group'){
    mode='time';
    toggleLayoutBtn.textContent = 'Modo: Proximidade';
    renderTime();
    radarWrap.classList.remove('grouped'); radarWrap.classList.add('timeline');
  } else {
    mode='group';
    toggleLayoutBtn.textContent = 'Modo: Prioridade';
    renderGrouped();
    radarWrap.classList.remove('timeline'); radarWrap.classList.add('grouped');
  }
}
toggleLayoutBtn.addEventListener('click', toggleLayout);

/* global keyboard shortcuts */
document.addEventListener('keydown',(e)=>{
  if(e.metaKey || e.ctrlKey || e.altKey) return;
  if(e.key.toLowerCase()==='m') { toggleLayout(); e.preventDefault(); }
  if(e.key.toLowerCase()==='h') { helpBtn.click(); e.preventDefault(); }
});

/* initial render */
renderGrouped();

/* a11y live announce (brief) */
(function announce(){ const live = document.createElement('div'); live.className='sr-only'; live.setAttribute('aria-live','polite'); live.textContent='Radar carregado'; document.body.appendChild(live); setTimeout(()=> live.remove(),1200); })();
</script>
</body>
</html>
