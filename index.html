<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<meta name="color-scheme" content="dark">
<meta name="theme-color" content="#03040a">
<title>Radar de Editais ‚Äî Virtus et Honor</title>

<script>
  (function earlyBgSetup(){
    try {
      const isEmbed = window.self !== window.top;
      if(isEmbed){
        document.documentElement.style.background = 'transparent';
        document.documentElement.style.setProperty('background-color','transparent','important');
        document.documentElement.dataset.embed = 'true';
      } else {
        document.documentElement.style.background = '#03040a';
        document.documentElement.style.setProperty('background-color','#03040a','important');
      }
    } catch(e){}
  })();
</script>

<style>
  :root{
    --bg-start:#03040a;
    --bg-end:#0b1118;
    --card-start:#071019;
    --card-end:#0f1723;
    --muted:rgba(230,230,230,.72);
    --accent-1:#8be9fd;
    --accent-2:#bd93f9;
    --accent-3:#ff79c6;
    --danger:#ff3b3b;
    --warn:#ffd93b;
    --info:#3ba0ff;
    --success:#50fa7b;
    --radius:12px;
    --max-default:980px;
    --max-wide:1320px;
    --transition:.18s;
    --font-sans:Inter,system-ui,-apple-system,"Segoe UI",Roboto, "Helvetica Neue", Arial, sans-serif;
  }

  *,*::before,*::after{box-sizing:border-box}
  html,body{
    width:100%;height:100%;margin:0 !important;padding:0 !important;
    color:#e6e6e6;font-family:var(--font-sans);-webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;background: transparent;
  }
  html:not([data-embed]) body {
    background: linear-gradient(180deg,var(--bg-start),var(--bg-end));
    min-height:100vh;
  }
  html[data-embed] body {
    background: transparent; min-height:0;
  }

  #radarWrap{width:100%;max-width:var(--max-default);margin:0 auto;padding:0;transition:max-width var(--transition) ease}
  #radar{background: linear-gradient(180deg,var(--bg-start),var(--bg-end));border:1px solid rgba(255,255,255,.03);padding:16px;border-radius:14px;box-shadow:0 8px 30px rgba(2,6,23,.6)}

  .header{display:flex;align-items:center;justify-content:space-between;gap:8px;margin-bottom:10px}
  .title{font-weight:800;font-size:18px;background:linear-gradient(90deg,var(--accent-1),var(--accent-2),var(--accent-3));-webkit-background-clip:text;color:transparent}
  .subtitle{font-size:12px;color:var(--muted)}
  .controls{display:flex;gap:8px;align-items:center}
  .ctrl-btn{background:transparent;border:1px solid rgba(255,255,255,.04);padding:6px 10px;border-radius:8px;cursor:pointer;color:var(--muted);font-size:13px}
  .ctrl-btn:focus{outline:3px solid rgba(139,233,253,.12);outline-offset:3px}
  .ctrl-btn:hover{border-color:rgba(255,255,255,.08)}

  .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:12px;align-items:start}
  .section-title{grid-column:span 12;color:var(--muted);font-size:16px;margin-top:6px;margin-bottom:6px;font-weight:700}

  .card{grid-column:span 12;background:linear-gradient(145deg,var(--card-start),var(--card-end));border:1px solid rgba(255,255,255,.03);padding:10px;border-radius:var(--radius);position:relative;cursor:pointer;transition:transform .14s ease,border-color .14s ease,box-shadow .14s ease;user-select:none;display:flex;align-items:center;justify-content:space-between;gap:12px}
  .card:hover{transform:translateY(-4px);box-shadow:0 12px 36px rgba(0,0,0,.5);border-color:rgba(255,255,255,.06)}
  .card.small{padding:8px}
  .card::before{content:"";position:absolute;left:0;top:0;bottom:0;width:4px;border-radius:6px 0 0 6px}
  .alvo::before{background:var(--danger)} .obs::before{background:var(--warn)} .reta::before{background:var(--info)}

  .card .left{display:flex;flex-direction:column;gap:4px}
  .name{font-weight:700;font-size:15px}
  .meta{font-size:12px;color:var(--muted)}
  .pill{font-size:11px;padding:6px 10px;border-radius:999px;background:rgba(0,0,0,.28);border:1px solid rgba(255,255,255,.03);white-space:nowrap}
  .pill.previsto{color:var(--accent-1);border-color:var(--accent-1)} .pill.autorizado{color:var(--success);border-color:var(--success)}
  .pill.pldo{color:var(--warn);border-color:var(--warn)} .pill.longo{color:var(--info);border-color:var(--info)}
  .tag-small{font-size:11px;color:var(--muted)}

  .note{margin-top:12px;font-size:12px;color:var(--muted);opacity:.95}

  .sr-only{position:absolute !important;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
  iframe,embed,object{background:transparent !important}

  @media (min-width:980px){
    #radarWrap.grouped .grid .card.half{grid-column:span 6}
  }
  @media (max-width:980px){
    #radar{padding:12px}
    .card{padding:10px}
    .pill{padding:5px 8px}
  }
</style>
</head>

<body>
<div id="radarWrap" class="grouped" role="region" aria-label="Radar de Editais ‚Äî Virtus et Honor">
  <div id="radar" role="application" aria-describedby="radar-note">
    <div class="header">
      <div>
        <div class="title">üì° Radar de Editais ‚Äî Virtus et Honor</div>
        <div class="subtitle" id="updatedAt">Atualizado em: 20/02/2026</div>
      </div>

      <div class="controls" role="toolbar" aria-label="Controles do widget">
        <button id="toggleLayout" class="ctrl-btn" title="Mudar modo: Agrupar / Linha do Tempo">Modo: Agrupar</button>
        <button id="helpBtn" class="ctrl-btn" title="Ajuda (H)">i</button>
      </div>
    </div>

    <div class="grid" id="grid" role="list" aria-live="polite"></div>

    <!-- footer note removed as requested -->
  </div>
</div>

<!-- MODAL -->
<div id="modalBg" class="modal-bg" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle" tabindex="-1">
    <div class="modal-header">
      <div>
        <h3 id="modalTitle"></h3>
        <div class="subtitle" id="modalSub"></div>
      </div>
      <div>
        <button class="fechar" id="modalClose" aria-label="Fechar">‚úï</button>
      </div>
    </div>
    <div class="modal-body" id="modalBody" tabindex="0"></div>
  </div>
</div>

<!-- ===== novo script substitu√≠do e corrigido ===== -->
<script>
/* ========= DATA ========= */
const concursos = [
  {key:"pmgo",titulo:"PM-GO",grupo:"alvo",tag:"PREVISTO",data:"2026-09-01",html:`<strong>PM-GO ‚Äî Soldado</strong><br>Pr√≥ximo edital: jul‚Äìout/2026. Pico set. Prova nov.`},
  {key:"prf",titulo:"PRF",grupo:"alvo",tag:"M√âDIO PRAZO",data:"2026-11-01",html:`<strong>PRF</strong><br>Concurso 2021 v√°lido at√© jun/2026. Poss√≠vel edital 2¬∫ semestre/2026.`},

  {key:"pcmt",titulo:"PC-MT",grupo:"obs",tag:"PLDO",data:"2026-10-01",html:`<strong>PC-MT</strong><br>Previsto no PLDO 2026.`},
  {key:"pmt",titulo:"PM-MT",grupo:"obs",tag:"PLDO",data:"2026-10-15",html:`<strong>PM-MT</strong><br>Previsto no PLDO; depende de dota√ß√£o.`},
  {key:"pcdf",titulo:"PC-DF",grupo:"obs",tag:"AUTORIZADO",data:"2026-12-01",html:`<strong>PC-DF</strong><br>Autorizado: 105 vagas + 210 CR.`},
  {key:"pcpr",titulo:"PC-PR",grupo:"obs",tag:"AUTORIZADO",data:"2026-09-15",html:`<strong>PC-PR</strong><br>Autorizado e comiss√£o formada.`},

  {key:"pf",titulo:"PF",grupo:"reta",tag:"LONGO PRAZO",data:"2028-06-01",html:`<strong>PF</strong><br>Pr√≥ximo grande concurso tende a 2028+.`},
  {key:"pcgo",titulo:"PC-GO",grupo:"reta",tag:"ESTUDO",data:"2027-03-01",html:`<strong>PC-GO</strong><br>Em estudo; poss√≠vel 2026‚Äì2027.`},
  {key:"pcto",titulo:"PC-TO",grupo:"reta",tag:"COMISS√ÉO",data:"2027-02-01",html:`<strong>PC-TO</strong><br>Comiss√µes e movimenta√ß√µes.`}
];

const gruposOrdem = [
  { id:"alvo", titulo:"üëÅ‚Äçüó® Em Alvo (Prioridade M√°xima)" },
  { id:"obs",  titulo:"‚ö†Ô∏è Em Observa√ß√£o" },
  { id:"reta", titulo:"‚ùÑÔ∏è Na Retaguarda" }
];

const grid = document.getElementById("grid");
const modalBg = document.getElementById("modalBg");
const modal = modalBg.querySelector(".modal");
const modalTitle = document.getElementById("modalTitle");
const modalSub = document.getElementById("modalSub");
const modalBody = document.getElementById("modalBody");
const toggleLayoutBtn = document.getElementById("toggleLayout");
const helpBtn = document.getElementById("helpBtn");
const radarWrap = document.getElementById("radarWrap");

let mode = "group";

/* helper: tempo restante */
function tempoRestante(data){
  const alvo = new Date(data);
  const hoje = new Date();
  const diff = alvo - hoje;
  if(diff<=0) return "SAIU";
  const days = Math.floor(diff/86400000);
  const months = Math.floor(days/30);
  if(months>0) return `${months}m`;
  return `${days}d`;
}

/* render grouped */
function renderGrouped(){
  grid.innerHTML = '';
  for(const g of gruposOrdem){
    const sec = document.createElement('div');
    sec.className = 'section-title';
    sec.textContent = g.titulo;
    grid.appendChild(sec);
    const itens = concursos.filter(c=>c.grupo===g.id);
    for(const c of itens){
      const el = document.createElement('div');
      el.className = `card ${c.grupo}`;
      el.setAttribute('data-key', c.key);
      el.tabIndex = 0;
      el.innerHTML = `
        <div class="left">
          <div class="name">${c.titulo}</div>
        </div>
        <div><span class="pill ${pillClass(c.tag)}">${c.tag}</span></div>
      `;
      el.addEventListener('click', ()=> openModalByKey(c.key));
      el.addEventListener('keydown', (e)=> { if(e.key==='Enter' || e.key===' '){ e.preventDefault(); openModalByKey(c.key); }});
      grid.appendChild(el);
    }
  }
}

/* render time-ordered (no timeline bar) */
function renderTime(){
  grid.innerHTML = '';
  const items = [...concursos].sort((a,b)=> new Date(a.data)-new Date(b.data));
  for(const c of items){
    const el = document.createElement('div');
    el.className = `card ${c.grupo} small`;
    el.setAttribute('data-key', c.key);
    el.tabIndex = 0;
    el.innerHTML = `
      <div style="text-align:center">
        <div style="font-size:20px;font-weight:700">‚è≥ ${tempoRestante(c.data)}</div>
        <div style="font-size:12px;color:var(--muted);margin-top:6px">${c.titulo}</div>
      </div>
    `;
    el.addEventListener('click', ()=> openModalByKey(c.key));
    el.addEventListener('keydown', (e)=> { if(e.key==='Enter' || e.key===' '){ e.preventDefault(); openModalByKey(c.key); }});
    grid.appendChild(el);
  }
}

/* pill color mapping */
function pillClass(label){
  const map = {
    'PREVISTO':'previsto',
    'M√âDIO PRAZO':'previsto',
    'PLDO':'pldo',
    'AUTORIZADO':'autorizado',
    'LONGO PRAZO':'longo',
    'ESTUDO':'pldo',
    'COMISS√ÉO':'pldo'
  };
  return map[label] || '';
}

/* modal open by key */
let lastFocused = null;
function openModalByKey(key){
  const data = concursos.find(c=>c.key===key);
  if(!data) return;
  lastFocused = document.activeElement;
  modalTitle.textContent = data.titulo;
  modalSub.textContent = ''; // removed footer/source as requested
  modalBody.innerHTML = data.html;
  modalBg.classList.add('open');
  requestAnimationFrame(()=> modal.classList.add('open'));
  modalBg.setAttribute('aria-hidden','false');
  modal.setAttribute('tabindex','-1'); setTimeout(()=> modal.focus(),120);
  try{ document.documentElement.style.overflow='hidden'; }catch(e){}
}
function closeModal(){
  modal.classList.remove('open');
  modalBg.classList.remove('open');
  modalBg.setAttribute('aria-hidden','true');
  try{ document.documentElement.style.overflow=''; }catch(e){}
  if(lastFocused && typeof lastFocused.focus === 'function') lastFocused.focus();
}
document.getElementById('modalClose').addEventListener('click', closeModal);
modalBg.addEventListener('click', (e)=>{ if(e.target===modalBg) closeModal(); });

/* toggle layout */
function toggleLayout(){
  if(mode==='group'){
    mode='time';
    toggleLayoutBtn.textContent = 'Modo: Linha do Tempo';
    renderTime();
    radarWrap.classList.remove('grouped');
    radarWrap.classList.add('timeline');
  } else {
    mode='group';
    toggleLayoutBtn.textContent = 'Modo: Agrupar';
    renderGrouped();
    radarWrap.classList.remove('timeline');
    radarWrap.classList.add('grouped');
  }
}
toggleLayoutBtn.addEventListener('click', toggleLayout);

/* help button opens help modal */
helpBtn.addEventListener('click', ()=> {
  // build help content inline
  modalTitle.textContent = 'Ajuda ‚Äî Radar';
  modalSub.textContent = '';
  modalBody.innerHTML = `
    <strong>Opera√ß√£o r√°pida</strong><br><br>
    - Clique em um card para abrir a descri√ß√£o completa do concurso.<br>
    - Fechar modal: ESC, clicar fora ou no ‚úï.<br>
    - Pressione "M" para alternar entre modos (Agrupado / Linha do Tempo).<br>
    - Pressione "H" para abrir esta ajuda.<br>
  `;
  modalBg.classList.add('open'); requestAnimationFrame(()=> modal.classList.add('open'));
});

/* keyboard shortcuts */
document.addEventListener('keydown',(e)=>{
  if(e.key==='Escape' && modalBg.classList.contains('open')) closeModal();
  if(!e.ctrlKey && !e.metaKey && !e.altKey){
    if(e.key.toLowerCase()==='m') toggleLayout();
    if(e.key.toLowerCase()==='h') helpBtn.click();
  }
});

/* initial render */
renderGrouped();

/* accessibility announce */
(function announce(){ const live=document.createElement('div'); live.className='sr-only'; live.setAttribute('aria-live','polite'); live.textContent='Radar carregado'; document.body.appendChild(live); setTimeout(()=> live.remove(),1200); })();
</script>
</body>
</html>
